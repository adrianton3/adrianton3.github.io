<!DOCTYPE html>

<html>
<head>
	<title>functional math lib</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=3.0">
	<link rel="stylesheet" media="all" href="../../static/docco-small-tab.css">
	<link rel="stylesheet" media="all" href="../../static/highlight.css">
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="benchmark.html">
                benchmark.js
              </a>
            
              
              <a class="source" href="math-lib-array.html">
                math-lib-array.js
              </a>
            
              
              <a class="source" href="math-lib-object.html">
                math-lib-object.js
              </a>
            
              
              <a class="source" href="math-lib.html">
                math-lib.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        <li id="section-1">
            <div class="annotation">
				
					<a href="../../index.html">Back to index</a>
				
				<h1 id="functional-math-lib">functional math lib</h1>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-2">&#182;</a>
					</div>
				
				
            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-3">&#182;</a>
					</div>
				
				<p>This is a short experiment showing the usage and implementation of a simple math lib.
The library should cover dealing with vectors and matrices.
This small snippet only covers vector types.</p>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-4">&#182;</a>
					</div>
				
				<p>Let’s first make a proposal for how the API should look like.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> demo = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">implementation</span>) </span>{
<span class="hljs-meta">	'use strict'</span>;

	<span class="hljs-keyword">var</span> { make, getX, getY, getZ, add, scale, length } = implementation;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-5">&#182;</a>
					</div>
				
				<p>Let’s create 2 vectors</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> v1 = make(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);
	<span class="hljs-keyword">var</span> v2 = make(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-6">&#182;</a>
					</div>
				
				<p>And add them together</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> sum = v1(add(v2));</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-7">&#182;</a>
					</div>
				
				<p>In coffeescript this can be rewritten without the parentheses like so
<code>sum = v1 add v2</code>
which is the most natural way of expressing this in a language without operator overloading</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
	<span class="hljs-keyword">var</span> doubleSum = sum(scale(<span class="hljs-number">2</span>));</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-8">&#182;</a>
					</div>
				
				<p>Again, in coffeescript this looks way better <code>doubleSum = sum scale 2</code>
or, in expanded form <code>doubleSum = (v1 add v2) scale 2</code></p>

            </div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-9">&#182;</a>
					</div>
				
				<p>So far so good, but how do we get the data back from the vector now?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> x = doubleSum(getX);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-10">&#182;</a>
					</div>
				
				<h2 id="the-implementation">The implementation</h2>

            </div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-11">&#182;</a>
					</div>
				
				
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">window</span>.Vec3Closure = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">	'use strict'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-12">&#182;</a>
					</div>
				
				<p>The “constructor” doesn’t make use of any objects,
<code>this</code> (and <code>new</code>), hidden state or TypedArrays.
Everything is bound to a value and cannot be altered.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">make</span>(<span class="hljs-params">x, y, z</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vec3</span>(<span class="hljs-params">fun</span>) </span>{
			<span class="hljs-keyword">return</span> fun(x, y, z);
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-13">&#182;</a>
					</div>
				
				<p>Accessors are probably the simplest function that can be applied on a vector.
Notice how the vector’s components are passed as arguments to the accessors.
The functions fed to a vector have no way of mutating the vector’s contents.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getX</span>(<span class="hljs-params">x, y, z</span>) </span>{
		<span class="hljs-keyword">return</span> x;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getY</span>(<span class="hljs-params">x, y, z</span>) </span>{
		<span class="hljs-keyword">return</span> y;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getZ</span>(<span class="hljs-params">x, y, z</span>) </span>{
		<span class="hljs-keyword">return</span> z;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-14">&#182;</a>
					</div>
				
				<p>Operations, the minimum required</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">that</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x, y, z</span>) </span>{
			<span class="hljs-keyword">return</span> make(
				x + that(getX),
				y + that(getY),
				z + that(getZ)
			);
		}
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scale</span>(<span class="hljs-params">s</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x, y, z</span>) </span>{
			<span class="hljs-keyword">return</span> make(
				x * s,
				y * s,
				z * s
			);
		}
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">length</span>(<span class="hljs-params">x, y, z</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.sqrt(x * x + y * y + z * z);
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-15">&#182;</a>
					</div>
				
				<p>Wait, there’s no need to copy vectors since they are immutable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copy</span>(<span class="hljs-params">x, y, z</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-16">&#182;</a>
					</div>
				
				<p>It would, actually, be just an alias for the constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> make(x, y, z);
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-17">&#182;</a>
					</div>
				
				<p>Export it all</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">return</span> { make, getX, getY, getZ, add, scale, length };
})();</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
				
					
					<div class="pilwrap ">
						<a class="pilcrow" href="#section-18">&#182;</a>
					</div>
				
				<p>It’s possible to generalize the above scheme for vec2, vec4 and matrices.
For now let’s feed the demo with our current implementation.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>demo(<span class="hljs-built_in">window</span>.Vec3Closure);</pre></div></div>
            
        </li>
        
    </ul>
  </div>

  <script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-45334894-6', {
		  'storage': 'none',
	  });
	  ga('send', 'pageview');
  </script>
</body>
</html>